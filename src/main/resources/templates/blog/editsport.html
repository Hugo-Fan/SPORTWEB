<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#712cf9">
    <title>deitSport</title>
    <link rel="icon" th:href="@{/dumbbel.ico}" type="image/x-icon"/>

    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

    <style>
      .limited-width {
        white-space: nowrap; /* 避免文字換行 */
        text-overflow: ellipsis; /* 如果超出，使用省略號表示 */
      }
    </style>
</head>
<body class="bg-light" style="min-height: 100vh;">
<div class="container">
    <main>
        <div class="row g-5">
            <div class="col-md-7 col-lg-8">
                <h3 class="mb-3 mt-3">紀錄運動</h3>
                <form th:action="@{/sport/editSport}" method="post">
                    <div class="row">
                        <div class="col">
                            <table>
                                <td><label for="actionGroup" class="limited-width">動作日</label></td>
                                <td><input class="form-control" type="text" id="actionGroup" name="actionGroup"
                                           th:value="${sportlist.actiongroup}"></td>
                            </table>
                        </div>
                        <div class="col">
                            <table>
                                <td><label for="date" class="limited-width">日期</label></td>
                                <td><input class="form-control" type="text" id="date" name="date"
                                           th:value="${sportlist.date}"></td>
                            </table>
                        </div>

                        <div >
                            <label for="date" class="limited-width">動作內容</label>
                            <div id="fieldsContainer">
                                <div class="sports" th:each="sport,loopStats : ${sportlist.sportlists}">
                                    <td>
                                        <input class="form-control-5" type="text" name="sports"  th:value="${sport}">
                                    </td>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" th:value="${sportlist.user_id}" name="user_id">
                        <input type="hidden" th:value="${sportlist.sport_id}" name="sport_id">

                        <div class="table-responsive">
                            <table>
                                <tr>
                                    <td><button class="btn btn-info" type="button" onclick="addFields()">新增欄位</button></td>

                                    <td><button class="btn btn-info" type="button" onclick="removeLastField()">刪除最後欄位</button></td>
                                </tr>
                            </table>
                        </div>
                        <hr class="my-4">
                        <button class="w-100 btn btn-lg btn-primary " type="submit">確認修改運動內容</button>
                    </div>
                </form>
            </div>
        </div>
    </main>
</div>
<script>
    function addFields() {
        // 複製第一組欄位
        var originalFields = document.querySelector('.sports');
        var clonedFields = originalFields.cloneNode(true);

        // 獲取所有欄位組
        var fieldGroups = document.querySelectorAll('.sports');
        var fieldCount = fieldGroups.length;

        // 清空複製的欄位的值
        var inputs = clonedFields.querySelectorAll('input');
        inputs.forEach(function(input) {
            input.value = '';
        });

        // 修改複製欄位的名稱
        clonedFields.setAttribute('name', 'sports' + (fieldCount + 1));

        // 將複製的欄位插入到容器中
        var container = document.getElementById('fieldsContainer');
        container.appendChild(clonedFields);
    }

    function removeLastField() {
        // 獲取所有欄位組
        var fieldGroups = document.querySelectorAll('.sports');

        // 如果只剩下一組欄位，不做任何操作
        if (fieldGroups.length <= 1) {
            return;
        }

        // 移除最後一組欄位
        var lastField = fieldGroups[fieldGroups.length - 1];
        lastField.parentNode.removeChild(lastField);
    }

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
</body>
</html>